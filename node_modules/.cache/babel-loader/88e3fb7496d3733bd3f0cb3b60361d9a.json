{"ast":null,"code":"var _jsxFileName = \"/Users/souvikdas/WebstormProjects/Group-9-Fronend/src/components/chat/chats.js\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { Container, Row, Col, Form, Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport UserChat from \"./userText\";\nimport \"./index.css\";\n\nfunction Chats(props) {\n  const [online, setOnline] = useState([]);\n  const [topic, setTopic] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [chat, setChat] = useState([]);\n  useEffect(() => {\n    setOnline(JSON.parse(localStorage.getItem(\"online\")));\n    setTopic(localStorage.getItem(\"topic\"));\n    setEmail(localStorage.getItem(\"email\"));\n  }, []);\n\n  const handleSubmit = () => {\n    axios({\n      url: \"https://us-central1-serverless-project-283717.cloudfunctions.net/publishMessage\",\n      method: \"POST\",\n      data: {\n        topic_name: topic,\n        username: email,\n        message: message\n      }\n    }).then(res => {\n      console.log(\"IN SUCCESS\");\n      console.log(res);\n      setMessage(\"\");\n    }).catch(error => {\n      console.log(\"IN ERROR\");\n      console.log(error);\n    });\n  };\n\n  useEffect(() => {\n    axios({\n      url: \"https://do3vuuv41l.execute-api.us-east-1.amazonaws.com/login/online\",\n      method: \"GET\"\n    }).then(res => {\n      // const temp = res.data[\"message\"];\n      const onlineUser = res.data.online;\n      localStorage.setItem(\"online\", JSON.stringify(onlineUser));\n      localStorage.setItem(\"topic\", \"Process\");\n    }).catch(({\n      response\n    }) => {\n      console.log(\"IN ERROR\");\n      console.log(response);\n    });\n  }, []);\n  useEffect(() => {\n    setTimeout(() => {\n      axios({\n        url: \"https://do3vuuv41l.execute-api.us-east-1.amazonaws.com/login/online\",\n        method: \"GET\"\n      }).then(res => {\n        // const temp = res.data[\"message\"];\n        const onlineUser = res.data.online;\n        console.log(\"IN SUCCESS\");\n        console.log(onlineUser);\n        console.log(typeof onlineUser);\n        axios({\n          url: \"https://us-central1-serverless-project-283717.cloudfunctions.net/createTopic\",\n          method: \"POST\",\n          data: {\n            topic_name: topic,\n            userID: [...onlineUser],\n            uniqueFileName: topic\n          }\n        }).then(res => {\n          console.log(\"IN SUCCESS\");\n          console.log(res);\n          localStorage.setItem('online', JSON.stringify(onlineUser));\n          localStorage.setItem('topic', topic);\n          props.history.push('/chatmain');\n        }).catch(({\n          response\n        }) => {\n          console.log(\"IN SUCCESS1\");\n          console.log(response);\n        });\n      }).catch(({\n        response\n      }) => {\n        console.log(\"IN ERROR\");\n        console.log(response);\n      });\n    }, 30000);\n  }, []);\n  useEffect(() => {\n    setInterval(() => {\n      axios({\n        url: \"https://us-central1-serverless-project-283717.cloudfunctions.net/listenMessages\",\n        method: \"POST\",\n        data: {\n          sub_id: localStorage.getItem(\"email\").split(\"@\")[0],\n          uniqueFileName: localStorage.getItem(\"topic\") + \".txt\"\n        }\n      }).then(res => {\n        let a = chat;\n\n        for (let i = 0; i < res.data.length; i++) {\n          a.push(res.data[i]);\n          console.log(\"LOG\", res.data[i]);\n        }\n\n        setChat([...a]);\n      }).catch(error => {\n        console.log(\"IN ERROR\");\n        console.log(error);\n      });\n    }, 4000);\n  }, []);\n  return /*#__PURE__*/React.createElement(Container, {\n    fluid: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: \"10\",\n    style: {\n      backgroundColor: \"#FFFFFF\",\n      height: \"92.5vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"chat-div pt-2 pb-2 pl-4 pr-4\",\n    style: {\n      height: \"90vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 11\n    }\n  }, chat.length !== 0 && chat.map(mychat => {\n    return mychat.data.length !== 0 && /*#__PURE__*/React.createElement(Row, {\n      className: \"justify-content-md-start\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(UserChat, {\n      message: mychat.data,\n      username: mychat.user,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 21\n      }\n    }));\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"m-0 pt-1 pb-1 border-div\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Col, {\n    xs: 10,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter message...\",\n    onChange: e => setMessage(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    variant: \"primary\",\n    onClick: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 17\n    }\n  }, \"Send\"))))), /*#__PURE__*/React.createElement(Col, {\n    xs: \"2\",\n    style: {\n      backgroundColor: \"#c1c1c1\",\n      height: \"92.5vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 9\n    }\n  }, online.map(user => {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 20\n      }\n    }, user);\n  }))));\n}\n\nexport default Chats; // <Container className={\"mt-5 p-0\"} style={{ backgroundColor: \"#FFFFFF\" }}>\n//   <div className={\"chat-div pt-2 pb-2 pl-4 pr-4\"}>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//   </div>\n//   <div className={\"p-2 border-div\"}>\n//     <Row>\n//       <Col xs={11}>\n//         <Form.Control type=\"text\" placeholder=\"Enter message...\" />\n//       </Col>\n//       <Col>\n//         <Button variant=\"primary\" type=\"submit\">\n//           send\n//         </Button>\n//       </Col>\n//     </Row>\n//   </div>\n// </Container>","map":{"version":3,"sources":["/Users/souvikdas/WebstormProjects/Group-9-Fronend/src/components/chat/chats.js"],"names":["React","useContext","useEffect","useState","Container","Row","Col","Form","Button","axios","UserChat","Chats","props","online","setOnline","topic","setTopic","email","setEmail","message","setMessage","chat","setChat","JSON","parse","localStorage","getItem","handleSubmit","url","method","data","topic_name","username","then","res","console","log","catch","error","onlineUser","setItem","stringify","response","setTimeout","userID","uniqueFileName","history","push","setInterval","sub_id","split","a","i","length","backgroundColor","height","map","mychat","user","e","target","value"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { Container, Row, Col, Form, Button } from \"react-bootstrap\";\nimport axios from \"axios\";\nimport UserChat from \"./userText\";\nimport \"./index.css\";\n\nfunction Chats(props) {\n  const [online, setOnline] = useState([]);\n  const [topic, setTopic] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [chat, setChat] = useState([]);\n\n  useEffect(() => {\n    setOnline(JSON.parse(localStorage.getItem(\"online\")));\n    setTopic(localStorage.getItem(\"topic\"));\n    setEmail(localStorage.getItem(\"email\"));\n  }, []);\n\n  const handleSubmit = () => {\n    axios({\n      url:\n        \"https://us-central1-serverless-project-283717.cloudfunctions.net/publishMessage\",\n      method: \"POST\",\n      data: {\n        topic_name: topic,\n        username: email,\n        message: message,\n      },\n    })\n      .then((res) => {\n        console.log(\"IN SUCCESS\");\n        console.log(res);\n        setMessage(\"\");\n      })\n      .catch((error) => {\n        console.log(\"IN ERROR\");\n        console.log(error);\n      });\n  };\n  useEffect(() => {\n    axios({\n      url:\n        \"https://do3vuuv41l.execute-api.us-east-1.amazonaws.com/login/online\",\n      method: \"GET\",\n    })\n      .then((res) => {\n        // const temp = res.data[\"message\"];\n        const onlineUser = res.data.online;\n        localStorage.setItem(\"online\", JSON.stringify(onlineUser));\n        localStorage.setItem(\"topic\", \"Process\");\n      })\n      .catch(({ response }) => {\n        console.log(\"IN ERROR\");\n        console.log(response);\n      });\n  }, []);\n\n  useEffect( () => {\n    setTimeout( () => {\n      axios({\n        url:\n            \"https://do3vuuv41l.execute-api.us-east-1.amazonaws.com/login/online\",\n        method: \"GET\",\n      })\n          .then((res) => {\n            // const temp = res.data[\"message\"];\n            const onlineUser = res.data.online\n            console.log(\"IN SUCCESS\");\n            console.log(onlineUser);\n            console.log(typeof(onlineUser));\n            axios({\n              url:\n                  \"https://us-central1-serverless-project-283717.cloudfunctions.net/createTopic\",\n              method: \"POST\",\n              data: {\n                topic_name: topic,\n                userID: [...onlineUser],\n                uniqueFileName: topic,\n              }\n            })\n                .then((res) => {\n                  console.log(\"IN SUCCESS\");\n                  console.log(res);\n                  localStorage.setItem('online', JSON.stringify(onlineUser));\n                  localStorage.setItem('topic', topic);\n                  props.history.push('/chatmain')\n                })\n                .catch(({ response }) => {\n                  console.log(\"IN SUCCESS1\");\n                  console.log(response);\n                });\n          })\n          .catch(({ response }) => {\n            console.log(\"IN ERROR\");\n            console.log(response);\n          });\n    }, 30000);\n  }, []);\n  useEffect(() => {\n    setInterval(() => {\n      axios({\n        url:\n          \"https://us-central1-serverless-project-283717.cloudfunctions.net/listenMessages\",\n        method: \"POST\",\n        data: {\n          sub_id: localStorage.getItem(\"email\").split(\"@\")[0],\n          uniqueFileName: localStorage.getItem(\"topic\") + \".txt\",\n        },\n      })\n        .then((res) => {\n          let a = chat;\n          for (let i = 0; i < res.data.length; i++) {\n            a.push(res.data[i]);\n            console.log(\"LOG\", res.data[i]);\n          }\n          setChat([...a]);\n        })\n        .catch((error) => {\n          console.log(\"IN ERROR\");\n          console.log(error);\n        });\n    }, 4000);\n  }, []);\n\n  return (\n    <Container fluid>\n      <Row>\n        <Col xs=\"10\" style={{ backgroundColor: \"#FFFFFF\", height: \"92.5vh\" }}>\n          <div\n            className={\"chat-div pt-2 pb-2 pl-4 pr-4\"}\n            style={{ height: \"90vh\" }}\n          >\n            {chat.length !== 0 &&\n            chat.map((mychat) => {\n              return (\n                mychat.data.length !== 0 && (\n                  <Row className=\"justify-content-md-start\">\n                    <UserChat message={mychat.data} username={mychat.user} />\n                  </Row>\n                )\n              );\n            })}\n          </div>\n          <div className={\"m-0 pt-1 pb-1 border-div\"}>\n            <Row>\n              <Col xs={10}>\n                <Form.Control\n                  type=\"text\"\n                  placeholder=\"Enter message...\"\n                  onChange={(e) => setMessage(e.target.value)}\n                />\n              </Col>\n              <Col>\n                <Button variant=\"primary\" onClick={handleSubmit}>\n                  Send\n                </Button>\n              </Col>\n            </Row>\n          </div>\n        </Col>\n        <Col xs=\"2\" style={{ backgroundColor: \"#c1c1c1\", height: \"92.5vh\" }}>\n          {online.map((user) => {\n            return <li>{user}</li>;\n          })}\n        </Col>\n      </Row>\n    </Container>\n  );\n}\n\nexport default Chats;\n\n// <Container className={\"mt-5 p-0\"} style={{ backgroundColor: \"#FFFFFF\" }}>\n//   <div className={\"chat-div pt-2 pb-2 pl-4 pr-4\"}>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-end\">\n//       <UserChat message={\"2\"} time={\"22:22\"} />\n//     </Row>\n//     <Row className=\"justify-content-md-start \">\n//       <OtherChat message={\"1\"} time={\"11:11\"} />\n//     </Row>\n//   </div>\n//   <div className={\"p-2 border-div\"}>\n//     <Row>\n//       <Col xs={11}>\n//         <Form.Control type=\"text\" placeholder=\"Enter message...\" />\n//       </Col>\n//       <Col>\n//         <Button variant=\"primary\" type=\"submit\">\n//           send\n//         </Button>\n//       </Col>\n//     </Row>\n//   </div>\n// </Container>\n"]},"metadata":{},"sourceType":"module"}